<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>hexsmoothR: Complete Guide to Hexagonal Grid Smoothing • hexsmoothR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="hexsmoothR: Complete Guide to Hexagonal Grid Smoothing">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hexsmoothR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/hexsmoothR-complete-guide.html">hexsmoothR: Complete Guide to Hexagonal Grid Smoothing</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>hexsmoothR: Complete Guide to Hexagonal Grid Smoothing</h1>
                        <h4 data-toc-skip class="author">Max M.
Lang</h4>
            
            <h4 data-toc-skip class="date">2026-01-09</h4>
      

      <div class="d-none name"><code>hexsmoothR-complete-guide.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>hexsmoothR implements hexagonal grid-based spatial smoothing
algorithms optimized for environmental data analysis. This vignette
demonstrates the complete workflow from data preparation through
hexagonal grid creation, data extraction, and spatial smoothing. The
hexagonal approach provides superior spatial averaging compared to
traditional square-grid methods, particularly for complex spatial
patterns and environmental data.</p>
</div>
<div class="section level2">
<h2 id="hexagonal-grid-advantages">Hexagonal Grid Advantages<a class="anchor" aria-label="anchor" href="#hexagonal-grid-advantages"></a>
</h2>
<p>Hexagonal grids offer several technical advantages for spatial
analysis:</p>
<ul>
<li>Six neighbors per cell vs. four in square grids</li>
<li>Eliminates diagonal artifacts and edge effects</li>
<li>Improved packing efficiency and uniform cell shapes</li>
<li>Consistent neighbor distances for spatial averaging</li>
</ul>
</div>
<div class="section level2">
<h2 id="coastal-data-demonstration">Coastal Data Demonstration<a class="anchor" aria-label="anchor" href="#coastal-data-demonstration"></a>
</h2>
<p>Coastal vegetation data demonstrates hexagonal smoothing
effectiveness:</p>
<ul>
<li>Complex, irregular shorelines challenging traditional grid
methods</li>
<li>Natural noise from water interference, cloud cover, and sensor
issues</li>
<li>Underlying environmental patterns suitable for spatial
enhancement</li>
<li>Clear visualization of smoothing algorithm performance</li>
</ul>
</div>
<div class="section level2">
<h2 id="workflow-overview">Workflow Overview<a class="anchor" aria-label="anchor" href="#workflow-overview"></a>
</h2>
<p>The complete hexagonal smoothing workflow:</p>
<ol style="list-style-type: decimal">
<li>Data preparation and validation</li>
<li>Hexagonal grid creation with appropriate cell sizing</li>
<li>Raster data extraction into hexagonal cells</li>
<li>Spatial topology setup for neighbor relationships</li>
<li>Weighted smoothing algorithm application</li>
<li>Result analysis and visualization</li>
</ol>
</div>
<div class="section level2">
<h2 id="data-source-and-characteristics">Data Source and Characteristics<a class="anchor" aria-label="anchor" href="#data-source-and-characteristics"></a>
</h2>
<p>Sentinel-2 L2A NDVI data from Copernicus Hub Ecosystem provides
authentic coastal vegetation patterns. NDVI values range from -0.8
(water/bare soil) to 1.6+ (dense vegetation).</p>
<p>The demonstration uses original Sentinel-2 data without artificial
noise, demonstrating hexagonal smoothing on authentic environmental
patterns. The algorithm enhances spatial patterns through neighbor
averaging while preserving underlying environmental signals.</p>
</div>
<div class="section level2">
<h2 id="algorithm-implementation">Algorithm Implementation<a class="anchor" aria-label="anchor" href="#algorithm-implementation"></a>
</h2>
<p>The hexagonal smoothing algorithm implements weighted neighbor
averaging:</p>
<ul>
<li>First-order neighbors: Directly adjacent hexagons</li>
<li>Second-order neighbors: Neighbors of first-order neighbors</li>
<li>Weighted averaging: Center cell and neighbors contribute according
to specified weights</li>
<li>Spatial preservation: Underlying patterns maintained during
smoothing</li>
</ul>
<p>The following sections provide implementation examples and technical
details for each workflow step.</p>
</div>
<div class="section level2">
<h2 id="key-concepts-and-implementation-details">Key Concepts and Implementation Details<a class="anchor" aria-label="anchor" href="#key-concepts-and-implementation-details"></a>
</h2>
<div class="section level3">
<h3 id="coordinate-reference-systems-crs">Coordinate Reference Systems (CRS)<a class="anchor" aria-label="anchor" href="#coordinate-reference-systems-crs"></a>
</h3>
<p>CRS selection affects hexagonal grid accuracy and cell sizing:</p>
<ul>
<li>Projected CRS (UTM, State Plane): cell_size in meters</li>
<li>Geographic CRS (WGS84, NAD83): cell_size in degrees</li>
<li>Package handles CRS transformations automatically</li>
<li>Production use: UTM coordinates with cell sizes in meters</li>
</ul>
</div>
<div class="section level3">
<h3 id="hexagon-geometry-and-measurements">Hexagon Geometry and Measurements<a class="anchor" aria-label="anchor" href="#hexagon-geometry-and-measurements"></a>
</h3>
<ul>
<li>
<code>cell_size</code> parameter: flat-to-flat distance (opposite
edges)</li>
<li>Pointy-topped hexagons: default configuration for neighbor
calculations</li>
<li>Helper functions: convert between measurement systems</li>
<li>Regular hexagons: consistent area ratios and neighbor distances</li>
</ul>
</div>
<div class="section level3">
<h3 id="spatial-topology-and-neighbor-relationships">Spatial Topology and Neighbor Relationships<a class="anchor" aria-label="anchor" href="#spatial-topology-and-neighbor-relationships"></a>
</h3>
<ul>
<li>First-order neighbors: directly adjacent hexagons sharing edges</li>
<li>Second-order neighbors: neighbors of first-order neighbors</li>
<li>Weight parameters: control center vs. neighbor cell influence</li>
<li>Implementation: weights applied to individual neighbors, not
neighbor means</li>
</ul>
<p>Spatial topology determines smoothing algorithm behavior. Each
hexagon receives weighted average of own value plus neighbor values,
with weights controlling local vs. neighborhood information balance.</p>
</div>
</div>
<div class="section level2">
<h2 id="step-1-library-loading-and-data-preparation">Step 1: Library Loading and Data Preparation<a class="anchor" aria-label="anchor" href="#step-1-library-loading-and-data-preparation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://maxmlang.github.io/hexsmoothR/">hexsmoothR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://isciences.gitlab.io/exactextractr/" class="external-link">exactextractr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define area of interest for coastal analysis</span></span>
<span><span class="va">bbox</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html" class="external-link">st_bbox</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="op">-</span><span class="fl">122.50</span>, ymin <span class="op">=</span> <span class="fl">47.62</span>, xmax <span class="op">=</span> <span class="op">-</span><span class="fl">122.54</span>, ymax <span class="op">=</span> <span class="fl">47.63</span><span class="op">)</span>,</span>
<span>  crs <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="fl">4326</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">aoi_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sfc.html" class="external-link">st_as_sfc</a></span><span class="op">(</span><span class="va">bbox</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"AOI: Puget Sound coastal region\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; AOI: Puget Sound coastal region</span></span>
<span></span>
<span><span class="co"># Load Sentinel-2 L2A NDVI data or fallback to simulated data</span></span>
<span><span class="va">sentinel_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"sentinel2_ndvi.tif"</span>, package <span class="op">=</span> <span class="st">"hexsmoothR"</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">sentinel_file</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">true_coastal_vegetation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">sentinel_file</span><span class="op">)</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Sentinel-2 L2A NDVI data loaded\n"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Using simulated coastal vegetation data\n"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Create a simple simulated elevation raster for demonstration</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span>  <span class="va">true_elevation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>nrows <span class="op">=</span> <span class="fl">100</span>, ncols <span class="op">=</span> <span class="fl">100</span>, </span>
<span>                         xmin <span class="op">=</span> <span class="op">-</span><span class="fl">122.54</span>, xmax <span class="op">=</span> <span class="op">-</span><span class="fl">122.50</span>, </span>
<span>                         ymin <span class="op">=</span> <span class="fl">47.62</span>, ymax <span class="op">=</span> <span class="fl">47.63</span>, </span>
<span>                         crs <span class="op">=</span> <span class="st">"EPSG:4326"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Simulate elevation with coastal gradient</span></span>
<span>  <span class="va">x_coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">122.54</span>, <span class="op">-</span><span class="fl">122.50</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span>  <span class="va">y_coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">47.62</span>, <span class="fl">47.63</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span>  <span class="va">coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x_coords</span>, y <span class="op">=</span> <span class="va">y_coords</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Create elevation pattern: higher inland, lower near coast</span></span>
<span>  <span class="va">elevation_values</span> <span class="op">&lt;-</span> <span class="fl">50</span> <span class="op">+</span> <span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="va">coords</span><span class="op">$</span><span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">coords</span><span class="op">$</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">coords</span><span class="op">$</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">coords</span><span class="op">$</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>                     <span class="fl">30</span> <span class="op">*</span> <span class="op">(</span><span class="va">coords</span><span class="op">$</span><span class="va">y</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">coords</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">coords</span><span class="op">$</span><span class="va">y</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">coords</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">coords</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">true_elevation</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">elevation_values</span></span>
<span>  </span>
<span>  <span class="co"># Simulate coastal vegetation pattern based on elevation</span></span>
<span>  <span class="va">vegetation_from_elev</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="va">true_elevation</span> <span class="op">/</span> <span class="fl">200</span><span class="op">)</span></span>
<span>  <span class="va">distance_effect</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">true_elevation</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">true_elevation</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> </span>
<span>                    <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">true_elevation</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">true_elevation</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">vegetation_from_distance</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">distance_effect</span> <span class="op">*</span> <span class="fl">0.6</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span>  <span class="va">coastal_patches</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">true_elevation</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">coastal_patches</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">ncell</a></span><span class="op">(</span><span class="va">true_elevation</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">0.3</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">true_coastal_vegetation</span> <span class="op">&lt;-</span> <span class="va">vegetation_from_elev</span> <span class="op">+</span> <span class="va">vegetation_from_distance</span> <span class="op">+</span> <span class="va">coastal_patches</span></span>
<span>  <span class="va">true_coastal_vegetation</span><span class="op">[</span><span class="va">true_coastal_vegetation</span> <span class="op">&lt;</span> <span class="fl">0.1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span>  <span class="va">true_coastal_vegetation</span><span class="op">[</span><span class="va">true_coastal_vegetation</span> <span class="op">&gt;</span> <span class="fl">0.8</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.8</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Sentinel-2 L2A NDVI data loaded</span></span>
<span></span>
<span><span class="co"># Use original data for hexagonal smoothing demonstration</span></span>
<span><span class="va">observed_coastal_vegetation</span> <span class="op">&lt;-</span> <span class="va">true_coastal_vegetation</span></span>
<span></span>
<span><span class="co"># Data summary</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">sentinel_file</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Sentinel-2 L2A NDVI data loaded\n"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Simulated coastal vegetation data\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Sentinel-2 L2A NDVI data loaded</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Dimensions:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">observed_coastal_vegetation</span><span class="op">)</span>, <span class="st">"x"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">observed_coastal_vegetation</span><span class="op">)</span>, <span class="st">"pixels\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dimensions: 176 x 292 pixels</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Resolution:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">xres</a></span><span class="op">(</span><span class="va">observed_coastal_vegetation</span><span class="op">)</span> <span class="op">*</span> <span class="fl">111320</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"m\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Resolution: 20 m</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"CRS:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/crs.html" class="external-link">crs</a></span><span class="op">(</span><span class="va">observed_coastal_vegetation</span>, proj <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; CRS: +proj=longlat +datum=WGS84 +no_defs</span></span>
<span><span class="va">missing_pct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/global.html" class="external-link">global</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">observed_coastal_vegetation</span><span class="op">)</span>, <span class="st">"mean"</span><span class="op">)</span><span class="op">$</span><span class="va">mean</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Missing values:"</span>, <span class="va">missing_pct</span>, <span class="st">"%\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Missing values: 0 0 0 %</span></span>
<span></span>
<span><span class="co"># Create color palette for NDVI visualization</span></span>
<span><span class="va">plot_colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkred"</span>, <span class="st">"red"</span>, <span class="st">"orange"</span>, <span class="st">"yellow"</span>, <span class="st">"green"</span>, <span class="st">"darkgreen"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Color palette: 100 colors (red to green)\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Color palette: 100 colors (red to green)</span></span>
<span></span>
<span><span class="co"># Plot 1: True underlying coastal vegetation pattern (NDVI-like)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">sentinel_file</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">plot_title_1</span> <span class="op">&lt;-</span> <span class="st">"Real Sentinel-2 L2A Coastal Vegetation Pattern (NDVI)\nThe signal to recover"</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="va">plot_title_1</span> <span class="op">&lt;-</span> <span class="st">"True Coastal Vegetation Pattern (NDVI-like)\nThe signal to recover"</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">true_coastal_vegetation</span><span class="op">$</span><span class="va">sentinel2_ndvi_1</span>, </span>
<span>     main <span class="op">=</span> <span class="va">plot_title_1</span>,</span>
<span>     col <span class="op">=</span> <span class="va">plot_colors</span>,</span>
<span>     axes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="hexsmoothR-complete-guide_files/figure-html/load-libraries-1.png" class="r-plt" alt="" width="960"></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Plot 2: Observed coastal vegetation data</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">sentinel_file</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">plot_title_2</span> <span class="op">&lt;-</span> <span class="st">"Observed Coastal Vegetation Data (NDVI)\nOriginal Sentinel-2 data"</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="va">plot_title_2</span> <span class="op">&lt;-</span> <span class="st">"Observed Coastal Vegetation Data (NDVI-like)\nSimulated data"</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">observed_coastal_vegetation</span><span class="op">$</span><span class="va">sentinel2_ndvi_3</span>,</span>
<span>     main <span class="op">=</span> <span class="va">plot_title_2</span>,</span>
<span>     col <span class="op">=</span> <span class="va">plot_colors</span>,</span>
<span>     axes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="hexsmoothR-complete-guide_files/figure-html/load-libraries-2.png" class="r-plt" alt="" width="960"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Individual plots created successfully!\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Individual plots created successfully!</span></span>
<span></span>
<span><span class="va">demo_raster</span> <span class="op">&lt;-</span> <span class="va">observed_coastal_vegetation</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="step-2-hexagonal-grid-creation">Step 2: Hexagonal Grid Creation<a class="anchor" aria-label="anchor" href="#step-2-hexagonal-grid-creation"></a>
</h2>
<p>Grid creation requires appropriate cell sizing and coordinate system
selection. Cell size determines spatial resolution and computational
requirements.</p>
<div class="section level3">
<h3 id="cell-size-and-crs-dependencies">Cell Size and CRS Dependencies<a class="anchor" aria-label="anchor" href="#cell-size-and-crs-dependencies"></a>
</h3>
<p>Cell size units depend on coordinate reference system:</p>
<ul>
<li>Projected CRS (UTM, State Plane): cell_size in meters</li>
<li>Geographic CRS (WGS84, NAD83): cell_size in degrees</li>
</ul>
<p>Use projected CRS (UTM) for accurate measurements.</p>
</div>
<div class="section level3">
<h3 id="cell-size-calculation">Cell Size Calculation<a class="anchor" aria-label="anchor" href="#cell-size-calculation"></a>
</h3>
<p>Calculate cell size to match target hexagon count and raster
area.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create study area polygon from raster extent</span></span>
<span><span class="va">study_area_wgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">st_sf</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html" class="external-link">st_sfc</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html" class="external-link">st_polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/ext.html" class="external-link">ext</a></span><span class="op">(</span><span class="va">demo_raster</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/ext.html" class="external-link">ext</a></span><span class="op">(</span><span class="va">demo_raster</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,  <span class="co"># xmin, ymin</span></span>
<span>      <span class="fu"><a href="https://rspatial.github.io/terra/reference/ext.html" class="external-link">ext</a></span><span class="op">(</span><span class="va">demo_raster</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/ext.html" class="external-link">ext</a></span><span class="op">(</span><span class="va">demo_raster</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,  <span class="co"># xmax, ymin</span></span>
<span>      <span class="fu"><a href="https://rspatial.github.io/terra/reference/ext.html" class="external-link">ext</a></span><span class="op">(</span><span class="va">demo_raster</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/ext.html" class="external-link">ext</a></span><span class="op">(</span><span class="va">demo_raster</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,  <span class="co"># xmax, ymax</span></span>
<span>      <span class="fu"><a href="https://rspatial.github.io/terra/reference/ext.html" class="external-link">ext</a></span><span class="op">(</span><span class="va">demo_raster</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/ext.html" class="external-link">ext</a></span><span class="op">(</span><span class="va">demo_raster</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,  <span class="co"># xmin, ymax</span></span>
<span>      <span class="fu"><a href="https://rspatial.github.io/terra/reference/ext.html" class="external-link">ext</a></span><span class="op">(</span><span class="va">demo_raster</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/ext.html" class="external-link">ext</a></span><span class="op">(</span><span class="va">demo_raster</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>, <span class="co"># back to start</span></span>
<span>    ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span><span class="op">)</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Study area CRS: WGS84\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Study area CRS: WGS84</span></span>
<span></span>
<span><span class="co"># Transform to UTM for accurate measurements</span></span>
<span><span class="va">utm_crs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_utm_crs.html">get_utm_crs</a></span><span class="op">(</span><span class="va">study_area_wgs</span><span class="op">)</span></span>
<span><span class="va">study_area_utm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">study_area_wgs</span>, <span class="va">utm_crs</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"UTM CRS:"</span>, <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">study_area_utm</span><span class="op">)</span><span class="op">$</span><span class="va">input</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; UTM CRS: EPSG:32610</span></span>
<span></span>
<span><span class="co"># Calculate cell size for target hexagon count</span></span>
<span><span class="co"># Convert degrees to meters (111320 factor, varies by latitude)</span></span>
<span><span class="va">raster_area_km2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">demo_raster</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">demo_raster</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">xres</a></span><span class="op">(</span><span class="va">demo_raster</span><span class="op">)</span> <span class="op">*</span> <span class="fl">111320</span><span class="op">/</span><span class="fl">1000</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">yres</a></span><span class="op">(</span><span class="va">demo_raster</span><span class="op">)</span> <span class="op">*</span> <span class="fl">111320</span><span class="op">/</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Target hexagon count for spatial resolution</span></span>
<span><span class="va">target_cells</span> <span class="op">&lt;-</span> <span class="fl">5000</span></span>
<span></span>
<span><span class="co"># Calculate cell size using hexagon area ratio (2.598)</span></span>
<span><span class="va">cell_size_meters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">raster_area_km2</span> <span class="op">*</span> <span class="fl">1e6</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">target_cells</span> <span class="op">*</span> <span class="fl">2.598</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Raster area:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">raster_area_km2</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"km²\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Raster area: 13.9 km²</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Target hexagons:"</span>, <span class="va">target_cells</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Target hexagons: 5000</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Cell size:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cell_size_meters</span>, <span class="fl">0</span><span class="op">)</span>, <span class="st">"m ("</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cell_size_meters</span><span class="op">/</span><span class="fl">1000</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"km)\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Cell size: 33 m ( 0 km)</span></span>
<span></span>
<span><span class="va">hex_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_grid.html">create_grid</a></span><span class="op">(</span><span class="va">study_area_utm</span>, cell_size <span class="op">=</span> <span class="va">cell_size_meters</span>, type <span class="op">=</span> <span class="st">"hexagonal"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Creating hexagonal grid...</span></span>
<span><span class="co">#&gt;   Cropping grid...</span></span>
<span><span class="co">#&gt;   Clipping grid...</span></span>
<span><span class="co">#&gt;   Transforming CRS...</span></span>
<span><span class="co">#&gt;   Grid created with 11223 cells</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Grid created:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">hex_grid</span><span class="op">)</span>, <span class="st">"cells\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Grid created: 11223 cells</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Average cell area:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_measures.html" class="external-link">st_area</a></span><span class="op">(</span><span class="va">hex_grid</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1e6</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"km²\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Average cell area: 0 km²</span></span>
<span></span>
<span><span class="co"># Transform to WGS84 for raster compatibility</span></span>
<span><span class="va">hex_grid_wgs84</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">hex_grid</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize grid overlay</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">demo_raster</span><span class="op">$</span><span class="va">sentinel2_ndvi_1</span>, main <span class="op">=</span> <span class="st">"Data with Hexagonal Grid"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">hex_grid_wgs84</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, border <span class="op">=</span> <span class="st">"white"</span>, lwd <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">hex_grid_wgs84</span><span class="op">)</span>, main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Hexagonal Grid -"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">hex_grid</span><span class="op">)</span>, <span class="st">"cells"</span><span class="op">)</span>, </span>
<span>     border <span class="op">=</span> <span class="st">"blue"</span>, lwd <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
<p><img src="hexsmoothR-complete-guide_files/figure-html/create-grid-1.png" class="r-plt" alt="" width="960"></p>
</div>
<div class="section level3">
<h3 id="helper-function-for-optimal-cell-size">Helper Function for Optimal Cell Size<a class="anchor" aria-label="anchor" href="#helper-function-for-optimal-cell-size"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Package suggests optimal cell size for target hexagon count</span></span>
<span><span class="va">target_cells</span> <span class="op">&lt;-</span> <span class="fl">5000</span></span>
<span><span class="va">optimal_cell_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/find_hex_cell_size_for_target_cells.html">find_hex_cell_size_for_target_cells</a></span><span class="op">(</span></span>
<span>  <span class="va">study_area_utm</span>, </span>
<span>  target_cells <span class="op">=</span> <span class="va">target_cells</span>, </span>
<span>  cell_size_min <span class="op">=</span> <span class="fl">20</span>,  </span>
<span>  cell_size_max <span class="op">=</span> <span class="fl">40</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   Creating hexagonal grid...</span></span>
<span><span class="co">#&gt;   Cropping grid...</span></span>
<span><span class="co">#&gt;   Clipping grid...</span></span>
<span><span class="co">#&gt;   Transforming CRS...</span></span>
<span><span class="co">#&gt;   Grid created with 29800 cells</span></span>
<span><span class="co">#&gt;   Creating hexagonal grid...</span></span>
<span><span class="co">#&gt;   Cropping grid...</span></span>
<span><span class="co">#&gt;   Clipping grid...</span></span>
<span><span class="co">#&gt;   Transforming CRS...</span></span>
<span><span class="co">#&gt;   Grid created with 7553 cells</span></span>
<span><span class="co">#&gt; [find_hex_cell_size_for_target_cells] n_cells at min (20.0000): 29800</span></span>
<span><span class="co">#&gt; [find_hex_cell_size_for_target_cells] n_cells at max (40.0000): 7553</span></span>
<span><span class="co">#&gt;   Creating hexagonal grid...</span></span>
<span><span class="co">#&gt;   Cropping grid...</span></span>
<span><span class="co">#&gt;   Clipping grid...</span></span>
<span><span class="co">#&gt;   Transforming CRS...</span></span>
<span><span class="co">#&gt;   Grid created with 13340 cells</span></span>
<span><span class="co">#&gt;   Creating hexagonal grid...</span></span>
<span><span class="co">#&gt;   Cropping grid...</span></span>
<span><span class="co">#&gt;   Clipping grid...</span></span>
<span><span class="co">#&gt;   Transforming CRS...</span></span>
<span><span class="co">#&gt;   Grid created with 9838 cells</span></span>
<span><span class="co">#&gt;   Creating hexagonal grid...</span></span>
<span><span class="co">#&gt;   Cropping grid...</span></span>
<span><span class="co">#&gt;   Clipping grid...</span></span>
<span><span class="co">#&gt;   Transforming CRS...</span></span>
<span><span class="co">#&gt;   Grid created with 8584 cells</span></span>
<span><span class="co">#&gt;   Creating hexagonal grid...</span></span>
<span><span class="co">#&gt;   Cropping grid...</span></span>
<span><span class="co">#&gt;   Clipping grid...</span></span>
<span><span class="co">#&gt;   Transforming CRS...</span></span>
<span><span class="co">#&gt;   Grid created with 8044 cells</span></span>
<span><span class="co">#&gt;   Creating hexagonal grid...</span></span>
<span><span class="co">#&gt;   Cropping grid...</span></span>
<span><span class="co">#&gt;   Clipping grid...</span></span>
<span><span class="co">#&gt;   Transforming CRS...</span></span>
<span><span class="co">#&gt;   Grid created with 7796 cells</span></span>
<span><span class="co">#&gt;   Creating hexagonal grid...</span></span>
<span><span class="co">#&gt;   Cropping grid...</span></span>
<span><span class="co">#&gt;   Clipping grid...</span></span>
<span><span class="co">#&gt;   Transforming CRS...</span></span>
<span><span class="co">#&gt;   Grid created with 7675 cells</span></span>
<span><span class="co">#&gt;   Creating hexagonal grid...</span></span>
<span><span class="co">#&gt;   Cropping grid...</span></span>
<span><span class="co">#&gt;   Clipping grid...</span></span>
<span><span class="co">#&gt;   Transforming CRS...</span></span>
<span><span class="co">#&gt;   Grid created with 7618 cells</span></span>
<span><span class="co">#&gt;   Creating hexagonal grid...</span></span>
<span><span class="co">#&gt;   Cropping grid...</span></span>
<span><span class="co">#&gt;   Clipping grid...</span></span>
<span><span class="co">#&gt;   Transforming CRS...</span></span>
<span><span class="co">#&gt;   Grid created with 7586 cells</span></span>
<span><span class="co">#&gt;   Creating hexagonal grid...</span></span>
<span><span class="co">#&gt;   Cropping grid...</span></span>
<span><span class="co">#&gt;   Clipping grid...</span></span>
<span><span class="co">#&gt;   Transforming CRS...</span></span>
<span><span class="co">#&gt;   Grid created with 7570 cells</span></span>
<span><span class="co">#&gt;   Creating hexagonal grid...</span></span>
<span><span class="co">#&gt;   Cropping grid...</span></span>
<span><span class="co">#&gt;   Clipping grid...</span></span>
<span><span class="co">#&gt;   Transforming CRS...</span></span>
<span><span class="co">#&gt;   Grid created with 7562 cells</span></span>
<span><span class="co">#&gt;   Creating hexagonal grid...</span></span>
<span><span class="co">#&gt;   Cropping grid...</span></span>
<span><span class="co">#&gt;   Clipping grid...</span></span>
<span><span class="co">#&gt;   Transforming CRS...</span></span>
<span><span class="co">#&gt;   Grid created with 7557 cells</span></span>
<span><span class="co">#&gt;   Creating hexagonal grid...</span></span>
<span><span class="co">#&gt;   Cropping grid...</span></span>
<span><span class="co">#&gt;   Clipping grid...</span></span>
<span><span class="co">#&gt;   Transforming CRS...</span></span>
<span><span class="co">#&gt;   Grid created with 7554 cells</span></span>
<span><span class="co">#&gt;   Creating hexagonal grid...</span></span>
<span><span class="co">#&gt;   Cropping grid...</span></span>
<span><span class="co">#&gt;   Clipping grid...</span></span>
<span><span class="co">#&gt;   Transforming CRS...</span></span>
<span><span class="co">#&gt;   Grid created with 7555 cells</span></span>
<span><span class="co">#&gt;   Creating hexagonal grid...</span></span>
<span><span class="co">#&gt;   Cropping grid...</span></span>
<span><span class="co">#&gt;   Clipping grid...</span></span>
<span><span class="co">#&gt;   Transforming CRS...</span></span>
<span><span class="co">#&gt;   Grid created with 7555 cells</span></span>
<span><span class="co">#&gt;   Creating hexagonal grid...</span></span>
<span><span class="co">#&gt;   Cropping grid...</span></span>
<span><span class="co">#&gt;   Clipping grid...</span></span>
<span><span class="co">#&gt;   Transforming CRS...</span></span>
<span><span class="co">#&gt;   Grid created with 7554 cells</span></span>
<span><span class="co">#&gt;   Creating hexagonal grid...</span></span>
<span><span class="co">#&gt;   Cropping grid...</span></span>
<span><span class="co">#&gt;   Clipping grid...</span></span>
<span><span class="co">#&gt;   Transforming CRS...</span></span>
<span><span class="co">#&gt;   Grid created with 7554 cells</span></span>
<span><span class="co">#&gt;   Creating hexagonal grid...</span></span>
<span><span class="co">#&gt;   Cropping grid...</span></span>
<span><span class="co">#&gt;   Clipping grid...</span></span>
<span><span class="co">#&gt;   Transforming CRS...</span></span>
<span><span class="co">#&gt;   Grid created with 7554 cells</span></span>
<span><span class="co">#&gt;   Creating hexagonal grid...</span></span>
<span><span class="co">#&gt;   Cropping grid...</span></span>
<span><span class="co">#&gt;   Clipping grid...</span></span>
<span><span class="co">#&gt;   Transforming CRS...</span></span>
<span><span class="co">#&gt;   Grid created with 7553 cells</span></span>
<span><span class="co">#&gt;   Creating hexagonal grid...</span></span>
<span><span class="co">#&gt;   Cropping grid...</span></span>
<span><span class="co">#&gt;   Clipping grid...</span></span>
<span><span class="co">#&gt;   Transforming CRS...</span></span>
<span><span class="co">#&gt;   Grid created with 7553 cells</span></span>
<span><span class="co">#&gt;   Creating hexagonal grid...</span></span>
<span><span class="co">#&gt;   Cropping grid...</span></span>
<span><span class="co">#&gt;   Clipping grid...</span></span>
<span><span class="co">#&gt;   Transforming CRS...</span></span>
<span><span class="co">#&gt;   Grid created with 7553 cells</span></span>
<span><span class="co">#&gt; [find_hex_cell_size_for_target_cells] Closest found: 39.9999 (diff: 2553)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Optimal cell size:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">optimal_cell_size</span>, <span class="fl">0</span><span class="op">)</span>, <span class="st">"m\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Optimal cell size: 40 m</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="import-existing-grid">Import Existing Grid<a class="anchor" aria-label="anchor" href="#import-existing-grid"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load existing hexagonal grid and ensure correct CRS</span></span>
<span><span class="va">existing_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="st">"path/to/your/hex_grid.shp"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">existing_grid</span><span class="op">)</span><span class="op">$</span><span class="va">input</span> <span class="op">!=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">study_area_utm</span><span class="op">)</span><span class="op">$</span><span class="va">input</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">existing_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">existing_grid</span>, crs <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">study_area_utm</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">hex_grid</span> <span class="op">&lt;-</span> <span class="va">existing_grid</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="step-3-extract-raster-data-into-hexagons">Step 3: Extract Raster Data into Hexagons<a class="anchor" aria-label="anchor" href="#step-3-extract-raster-data-into-hexagons"></a>
</h2>
<p>Extract raster values into hexagon cells using existing grid.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract raster values into hexagon cells</span></span>
<span><span class="co"># Function handles CRS transformations and pixel aggregation</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Raster data extraction\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Raster data extraction</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Using existing grid (cell_size = NULL)\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Using existing grid (cell_size = NULL)</span></span>
<span></span>
<span><span class="co"># Extract raster values using existing hexagonal grid</span></span>
<span><span class="va">extracted_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_raster_data.html">extract_raster_data</a></span><span class="op">(</span></span>
<span>  raster_files <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>coastal_vegetation <span class="op">=</span> <span class="va">demo_raster</span><span class="op">)</span>,</span>
<span>  hex_grid <span class="op">=</span> <span class="va">hex_grid_wgs84</span>,</span>
<span>  cell_size <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Extracting raster data from 1 terra::rast objects...</span></span>
<span><span class="co">#&gt; First raster object: coastal_vegetation </span></span>
<span><span class="co">#&gt; Dimensions: 176 x 292 </span></span>
<span><span class="co">#&gt; Resolution: 0.0001798288 0.0001215511 </span></span>
<span><span class="co">#&gt; CRS: GEOGCRS["WGS 84",</span></span>
<span><span class="co">#&gt;     ENSEMBLE["World Geodetic System 1984 ensemble",</span></span>
<span><span class="co">#&gt;         MEMBER["World Geodetic System 1984 (Transit)"],</span></span>
<span><span class="co">#&gt;         MEMBER["World Geodetic System 1984 (G730)"],</span></span>
<span><span class="co">#&gt;         MEMBER["World Geodetic System 1984 (G873)"],</span></span>
<span><span class="co">#&gt;         MEMBER["World Geodetic System 1984 (G1150)"],</span></span>
<span><span class="co">#&gt;         MEMBER["World Geodetic System 1984 (G1674)"],</span></span>
<span><span class="co">#&gt;         MEMBER["World Geodetic System 1984 (G1762)"],</span></span>
<span><span class="co">#&gt;         MEMBER["World Geodetic System 1984 (G2139)"],</span></span>
<span><span class="co">#&gt;         ELLIPSOID["WGS 84",6378137,298.257223563,</span></span>
<span><span class="co">#&gt;             LENGTHUNIT["metre",1]],</span></span>
<span><span class="co">#&gt;         ENSEMBLEACCURACY[2.0]],</span></span>
<span><span class="co">#&gt;     PRIMEM["Greenwich",0,</span></span>
<span><span class="co">#&gt;         ANGLEUNIT["degree",0.0174532925199433]],</span></span>
<span><span class="co">#&gt;     CS[ellipsoidal,2],</span></span>
<span><span class="co">#&gt;         AXIS["geodetic latitude (Lat)",north,</span></span>
<span><span class="co">#&gt;             ORDER[1],</span></span>
<span><span class="co">#&gt;             ANGLEUNIT["degree",0.0174532925199433]],</span></span>
<span><span class="co">#&gt;         AXIS["geodetic longitude (Lon)",east,</span></span>
<span><span class="co">#&gt;             ORDER[2],</span></span>
<span><span class="co">#&gt;             ANGLEUNIT["degree",0.0174532925199433]],</span></span>
<span><span class="co">#&gt;     USAGE[</span></span>
<span><span class="co">#&gt;         SCOPE["Horizontal component of 3D system."],</span></span>
<span><span class="co">#&gt;         AREA["World."],</span></span>
<span><span class="co">#&gt;         BBOX[-90,-180,90,180]],</span></span>
<span><span class="co">#&gt;     ID["EPSG",4326]] </span></span>
<span><span class="co">#&gt; No study area provided. Using raster CRS for grid creation.</span></span>
<span><span class="co">#&gt; Using provided hexagonal grid...</span></span>
<span><span class="co">#&gt; Processing coastal_vegetation ...</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |                                                                      |   1%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |==                                                                    |   4%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |=======                                                               |  11%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |=========                                                             |  14%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |==============                                                        |  21%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  22%  |                                                                              |================                                                      |  23%  |                                                                              |================                                                      |  24%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |=====================                                                 |  31%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |=======================                                               |  34%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  39%  |                                                                              |============================                                          |  40%  |                                                                              |============================                                          |  41%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |==============================                                        |  44%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |===================================                                   |  51%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |=====================================                                 |  54%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |==========================================                            |  61%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |============================================                          |  64%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |=================================================                     |  71%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |===================================================                   |  74%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  76%  |                                                                              |======================================================                |  77%  |                                                                              |======================================================                |  78%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  79%  |                                                                              |========================================================              |  80%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |==========================================================            |  84%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |===============================================================       |  91%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |=================================================================     |  94%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |====================================================================  |  98%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================|  99%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt;   Extracted 33669 valid values out of 3 total</span></span>
<span><span class="co">#&gt; Extraction done!</span></span>
<span><span class="co">#&gt; Total cells: 11223 </span></span>
<span><span class="co">#&gt; Variables: coastal_vegetation</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Extraction complete:"</span>, <span class="va">extracted_data</span><span class="op">$</span><span class="va">n_cells</span>, <span class="st">"cells\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Extraction complete: 11223 cells</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Variables:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">extracted_data</span><span class="op">$</span><span class="va">variables</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Variables: coastal_vegetation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Valid values:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">extracted_data</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">coastal_vegetation</span><span class="op">)</span><span class="op">)</span>, <span class="st">"/"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">extracted_data</span><span class="op">$</span><span class="va">data</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Valid values: 33669 / 11223</span></span>
<span></span>
<span><span class="co"># Data statistics comparison</span></span>
<span><span class="va">original_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">demo_raster</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">original_sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">demo_raster</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Handle data structure</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">is.list</a></span><span class="op">(</span><span class="va">extracted_data</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">coastal_vegetation</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">extracted_values</span> <span class="op">&lt;-</span> <span class="va">extracted_data</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">coastal_vegetation</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="va">extracted_values</span> <span class="op">&lt;-</span> <span class="va">extracted_data</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">coastal_vegetation</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">extracted_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">extracted_values</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">extracted_sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">extracted_values</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Data comparison:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Data comparison:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Original raster - Mean:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">original_mean</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"SD:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">original_sd</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Original raster - Mean: 0.169 SD: 0.232</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Extracted hexagons - Mean:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">extracted_mean</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"SD:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">extracted_sd</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Extracted hexagons - Mean: 0.119 SD: 0.202</span></span>
<span></span>
<span><span class="co"># Visualize extraction results</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">demo_raster</span><span class="op">$</span><span class="va">sentinel2_ndvi_1</span>, </span>
<span>     main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Original Raster ("</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">ncell</a></span><span class="op">(</span><span class="va">demo_raster</span><span class="op">)</span>, <span class="st">"pixels)"</span><span class="op">)</span>,</span>
<span>     col <span class="op">=</span> <span class="va">plot_colors</span><span class="op">)</span></span></code></pre></div>
<p><img src="hexsmoothR-complete-guide_files/figure-html/extract-raster-1.png" class="r-plt" alt="" width="960"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Plot extracted hexagon values</span></span>
<span><span class="va">hex_for_plot</span> <span class="op">&lt;-</span> <span class="va">hex_grid_wgs84</span></span>
<span><span class="va">hex_for_plot</span><span class="op">$</span><span class="va">value</span> <span class="op">&lt;-</span> <span class="va">extracted_values</span></span>
<span></span>
<span><span class="co"># Use base R plotting for consistency</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">hex_for_plot</span><span class="op">)</span>, </span>
<span>     col <span class="op">=</span> <span class="va">plot_colors</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">hex_for_plot</span><span class="op">$</span><span class="va">value</span>, <span class="fl">100</span><span class="op">)</span><span class="op">]</span>,</span>
<span>     main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Extracted Hexagon Coastal Vegetation Values (NDVI-like)\n("</span>, <span class="va">extracted_data</span><span class="op">$</span><span class="va">n_cells</span>, <span class="st">"hexagons)"</span><span class="op">)</span>,</span>
<span>     border <span class="op">=</span> <span class="st">"white"</span>, lwd <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span></code></pre></div>
<p><img src="hexsmoothR-complete-guide_files/figure-html/extract-raster-2.png" class="r-plt" alt="" width="960"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nExtraction process:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Extraction process:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- Left: Original coastal vegetation raster with"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">ncell</a></span><span class="op">(</span><span class="va">demo_raster</span><span class="op">)</span>, <span class="st">"pixels and noise\n"</span><span class="op">)</span>  </span>
<span><span class="co">#&gt; - Left: Original coastal vegetation raster with 51392 pixels and noise</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- Right: Extracted coastal vegetation values in"</span>, <span class="va">extracted_data</span><span class="op">$</span><span class="va">n_cells</span>, <span class="st">"hexagons\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; - Right: Extracted coastal vegetation values in 11223 hexagons</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- Each hexagon contains the average coastal vegetation of all pixels within its boundary\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; - Each hexagon contains the average coastal vegetation of all pixels within its boundary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- This aggregation already reduces some measurement noise!\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; - This aggregation already reduces some measurement noise!</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- **PERFECT ALIGNMENT**: extract_raster_data preserves grid orientation like exact_extract\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; - **PERFECT ALIGNMENT**: extract_raster_data preserves grid orientation like exact_extract</span></span>
<span></span>
<span><span class="co"># The extracted data contains:</span></span>
<span><span class="co"># - data: dataframe with extracted values</span></span>
<span><span class="co"># - variables: names of the extracted variables</span></span>
<span><span class="co"># - n_cells: number of grid cells</span></span></code></pre></div>
<div class="section level3">
<h3 id="benefits-of-using-terrarast-objects">Benefits of Using terra::rast Objects<a class="anchor" aria-label="anchor" href="#benefits-of-using-terrarast-objects"></a>
</h3>
<p>Using <code><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">terra::rast</a></code> objects instead of file paths provides
several advantages:</p>
<ol style="list-style-type: decimal">
<li>
<strong>CRS Inspection</strong>: Check coordinate systems before
extraction</li>
<li>
<strong>Data Validation</strong>: Verify dimensions, extent, and
data quality</li>
<li>
<strong>Pre-processing</strong>: Apply filters, transformations, or
cropping before extraction</li>
<li>
<strong>Memory Efficiency</strong>: Work with in-memory rasters for
repeated operations</li>
<li>
<strong>Error Prevention</strong>: Catch CRS or data issues early in
the workflow</li>
</ol>
</div>
<div class="section level3">
<h3 id="example-working-with-multiple-rasters">Example: Working with Multiple Rasters<a class="anchor" aria-label="anchor" href="#example-working-with-multiple-rasters"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load multiple rasters for inspection</span></span>
<span><span class="va">ndvi_raster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="st">"path/to/ndvi.tif"</span><span class="op">)</span></span>
<span><span class="va">elevation_raster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="st">"path/to/elevation.tif"</span><span class="op">)</span></span>
<span><span class="va">precipitation_raster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="st">"path/to/precipitation.tif"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Inspect each raster</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"NDVI raster:\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  CRS:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/crs.html" class="external-link">crs</a></span><span class="op">(</span><span class="va">ndvi_raster</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Dimensions:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ndvi_raster</span><span class="op">)</span>, <span class="st">"x"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">ndvi_raster</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Elevation raster:\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  CRS:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/crs.html" class="external-link">crs</a></span><span class="op">(</span><span class="va">elevation_raster</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Dimensions:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">elevation_raster</span><span class="op">)</span>, <span class="st">"x"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">elevation_raster</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ensure all rasters have compatible CRS and extent</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/crs.html" class="external-link">crs</a></span><span class="op">(</span><span class="va">ndvi_raster</span><span class="op">)</span> <span class="op">!=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/crs.html" class="external-link">crs</a></span><span class="op">(</span><span class="va">elevation_raster</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Warning: Rasters have different CRS\n"</span><span class="op">)</span></span>
<span>  <span class="co"># You could reproject here if needed</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Extract all variables at once</span></span>
<span><span class="va">extracted_multi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_raster_data.html">extract_raster_data</a></span><span class="op">(</span></span>
<span>  raster_files <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    ndvi <span class="op">=</span> <span class="va">ndvi_raster</span>,</span>
<span>    elevation <span class="op">=</span> <span class="va">elevation_raster</span>,</span>
<span>    precipitation <span class="op">=</span> <span class="va">precipitation_raster</span></span>
<span>  <span class="op">)</span>,</span>
<span>  study_area <span class="op">=</span> <span class="va">study_area_utm</span>,</span>
<span>  cell_size <span class="op">=</span> <span class="fl">20000</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="working-examples-wgs84-vs-utm">Working Examples: WGS84 vs UTM<a class="anchor" aria-label="anchor" href="#working-examples-wgs84-vs-utm"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example 1: WGS84 coordinates (geographic)</span></span>
<span><span class="co"># Use degrees for cell_size</span></span>
<span><span class="va">extracted_wgs84</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_raster_data.html">extract_raster_data</a></span><span class="op">(</span></span>
<span>  raster_files <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample_file</span><span class="op">)</span>,</span>
<span>  study_area <span class="op">=</span> <span class="va">study_area_wgs</span>,  <span class="co"># WGS84 coordinates</span></span>
<span>  cell_size <span class="op">=</span> <span class="fl">0.1</span>               <span class="co"># 0.1 degrees (~11km)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Example 2: UTM coordinates (projected)</span></span>
<span><span class="co"># Use meters for cell_size</span></span>
<span><span class="va">extracted_utm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_raster_data.html">extract_raster_data</a></span><span class="op">(</span></span>
<span>  raster_files <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample_file</span><span class="op">)</span>,</span>
<span>  study_area <span class="op">=</span> <span class="va">study_area_utm</span>,  <span class="co"># UTM coordinates</span></span>
<span>  cell_size <span class="op">=</span> <span class="fl">20000</span>             <span class="co"># 20000 meters (20km)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Example 3: No study area (uses raster CRS)</span></span>
<span><span class="co"># Function automatically determines appropriate units</span></span>
<span><span class="va">extracted_auto</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_raster_data.html">extract_raster_data</a></span><span class="op">(</span></span>
<span>  raster_files <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample_file</span><span class="op">)</span>,</span>
<span>  cell_size <span class="op">=</span> <span class="fl">0.1</span>               <span class="co"># 0.1 degrees (since raster is WGS84)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="step-4-configure-smoothing-topology">Step 4: Configure Smoothing Topology<a class="anchor" aria-label="anchor" href="#step-4-configure-smoothing-topology"></a>
</h2>
<div class="section level3">
<h3 id="standard-2-order-topology-backward-compatible">Standard 2-Order Topology (Backward Compatible)<a class="anchor" aria-label="anchor" href="#standard-2-order-topology-backward-compatible"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute spatial topology for smoothing (default: 2 orders)</span></span>
<span><span class="va">topology</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_topology.html">compute_topology</a></span><span class="op">(</span><span class="va">hex_grid</span><span class="op">)</span></span>
<span><span class="co">#&gt; Computing topology for area: grid with 2 neighbor orders</span></span>
<span><span class="co">#&gt;   Computed: avg_dist = 32.22 m, orders = 2</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Topology computed:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">topology</span><span class="op">$</span><span class="va">neighbors</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="st">"cells\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Topology computed: 11223 cells</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Average distance:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">topology</span><span class="op">$</span><span class="va">avg_distance</span>, <span class="fl">0</span><span class="op">)</span>, <span class="st">"m\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Average distance: 32 m</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Sigma (bandwidth):"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">topology</span><span class="op">$</span><span class="va">sigma</span>, <span class="fl">0</span><span class="op">)</span>, <span class="st">"m\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sigma (bandwidth): 16 m</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Gaussian weights:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Gaussian weights:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Center:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">topology</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">center_weight</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Center: 0.334</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"First-order:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">topology</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">neighbor_weights</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span> </span>
<span><span class="co">#&gt; First-order: 0.334</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Second-order:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">topology</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">neighbor_weights</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Second-order: 0.332</span></span>
<span></span>
<span><span class="co"># Weights applied to individual neighbors, not averages</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Weights applied to each neighbor individually\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Weights applied to each neighbor individually</span></span>
<span></span>
<span><span class="co"># Neighbor examples</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Cell 1:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">topology</span><span class="op">$</span><span class="va">neighbors</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="st">"1st,"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">topology</span><span class="op">$</span><span class="va">neighbors</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="st">"2nd neighbors\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Cell 1: 3 1st, 4 2nd neighbors</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Cell 2:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">topology</span><span class="op">$</span><span class="va">neighbors</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="st">"1st,"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">topology</span><span class="op">$</span><span class="va">neighbors</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="st">"2nd neighbors\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Cell 2: 4 1st, 6 2nd neighbors</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Cell 3:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">topology</span><span class="op">$</span><span class="va">neighbors</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="st">"1st,"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">topology</span><span class="op">$</span><span class="va">neighbors</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="st">"2nd neighbors\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Cell 3: 3 1st, 5 2nd neighbors</span></span>
<span></span>
<span><span class="co"># Note: Visualization code would go here but requires actual grid objects</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Neighborhood visualization would show:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Neighborhood visualization would show:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- Center cell (red)\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; - Center cell (red)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- 1st order neighbors (orange)\n"</span><span class="op">)</span> </span>
<span><span class="co">#&gt; - 1st order neighbors (orange)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- 2nd order neighbors (yellow)\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; - 2nd order neighbors (yellow)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="advanced-n-order-topology-for-enhanced-smoothing">Advanced: N-Order Topology for Enhanced Smoothing<a class="anchor" aria-label="anchor" href="#advanced-n-order-topology-for-enhanced-smoothing"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute topology with 3 neighbor orders for more extensive smoothing</span></span>
<span><span class="va">topology_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_topology.html">compute_topology</a></span><span class="op">(</span><span class="va">hex_grid</span>, neighbor_orders <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Computing topology for area: grid with 3 neighbor orders</span></span>
<span><span class="co">#&gt;   Computed: avg_dist = 32.38 m, orders = 3</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"3-Order topology computed:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">topology_3</span><span class="op">$</span><span class="va">neighbors</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="st">"cells\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; 3-Order topology computed: 11223 cells</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Neighbor orders:"</span>, <span class="va">topology_3</span><span class="op">$</span><span class="va">neighbor_orders</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Neighbor orders: 3</span></span>
<span></span>
<span><span class="co"># Weight computation details</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Average distance:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">topology_3</span><span class="op">$</span><span class="va">avg_distance</span>, <span class="fl">0</span><span class="op">)</span>, <span class="st">"m\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Average distance: 32 m</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Sigma (bandwidth):"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">topology_3</span><span class="op">$</span><span class="va">sigma</span>, <span class="fl">0</span><span class="op">)</span>, <span class="st">"m\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sigma (bandwidth): 16 m</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Gaussian weights for 3 orders:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Gaussian weights for 3 orders:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Center:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">topology_3</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">center_weight</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Center: 0.252</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">topology_3</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">neighbor_weights</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Order"</span>, <span class="va">i</span>, <span class="st">":"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">topology_3</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">neighbor_weights</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Order 1 : 0.251 </span></span>
<span><span class="co">#&gt; Order 2 : 0.25 </span></span>
<span><span class="co">#&gt; Order 3 : 0.247</span></span>
<span></span>
<span><span class="co"># Neighbor examples</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">topology_3</span><span class="op">$</span><span class="va">neighbors</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Cell"</span>, <span class="va">i</span>, <span class="st">":"</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">order</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">n_neighbors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">topology_3</span><span class="op">$</span><span class="va">neighbors</span><span class="op">[[</span><span class="va">order</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">" "</span>, <span class="va">n_neighbors</span>, <span class="va">order</span>, <span class="st">"st"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">" neighbors\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Cell 1 :  3 1 st  4 2 st  6 3 st neighbors</span></span>
<span><span class="co">#&gt; Cell 2 :  4 1 st  6 2 st  8 3 st neighbors</span></span>
<span><span class="co">#&gt; Cell 3 :  3 1 st  5 2 st  6 3 st neighbors</span></span>
<span></span>
<span><span class="co"># Custom weights for specific smoothing requirements</span></span>
<span><span class="va">topology_custom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_topology.html">compute_topology</a></span><span class="op">(</span></span>
<span>  <span class="va">hex_grid</span>, </span>
<span>  neighbor_orders <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  neighbor_weights_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.15</span>, <span class="fl">0.05</span><span class="op">)</span>  <span class="co"># Custom decay pattern</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Computing topology for area: grid with 4 neighbor orders</span></span>
<span><span class="co">#&gt;   Computed: avg_dist = 32.59 m, orders = 4</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Custom 4-order topology with manual weights\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Custom 4-order topology with manual weights</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Total weight sum:"</span>, <span class="va">topology_custom</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">center_weight</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">topology_custom</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">neighbor_weights</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Total weight sum: 1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="understanding-neighbor-orders">Understanding Neighbor Orders<a class="anchor" aria-label="anchor" href="#understanding-neighbor-orders"></a>
</h3>
<p>The neighbor order system determines how far the smoothing
extends:</p>
<ul>
<li>
<strong>1st order</strong>: Directly touching cells (6 for hexagons,
4 for squares)</li>
<li>
<strong>2nd order</strong>: Neighbors of neighbors (typically 12 for
hexagons)</li>
<li>
<strong>3rd order</strong>: Neighbors of neighbors of neighbors
(typically 18 for hexagons)</li>
<li>
<strong>Nth order</strong>: N levels of neighbor relationships</li>
</ul>
<p>Higher orders provide more extensive smoothing but increase
computation time and memory usage. The default 2-order system balances
performance and smoothing effectiveness for most applications.</p>
</div>
</div>
<div class="section level2">
<h2 id="step-5-apply-spatial-smoothing">Step 5: Apply Spatial Smoothing<a class="anchor" aria-label="anchor" href="#step-5-apply-spatial-smoothing"></a>
</h2>
<div class="section level3">
<h3 id="standard-2-order-smoothing-backward-compatible">Standard 2-Order Smoothing (Backward Compatible)<a class="anchor" aria-label="anchor" href="#standard-2-order-smoothing-backward-compatible"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Apply spatial smoothing using C++-optimized function (2 orders)</span></span>
<span><span class="va">smoothing_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smooth_variables.html">smooth_variables</a></span><span class="op">(</span></span>
<span>  variable_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>coastal_vegetation <span class="op">=</span> <span class="va">extracted_values</span><span class="op">)</span>,</span>
<span>  neighbors <span class="op">=</span> <span class="va">topology</span><span class="op">$</span><span class="va">neighbors</span>,</span>
<span>  weights <span class="op">=</span> <span class="va">topology</span><span class="op">$</span><span class="va">weights</span>,</span>
<span>  var_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"coastal_vegetation"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Using C++ implementation for N-order smoothing</span></span>
<span><span class="co">#&gt; Processing hexagon 5000 of 11223Processing hexagon 10000 of 11223</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Spatial smoothing complete\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Spatial smoothing complete</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Results:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">smoothing_results</span><span class="op">$</span><span class="va">coastal_vegetation</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Results: raw, weighted_combined, neighbors_1st, neighbors_2nd, smoothed_1st, smoothed_all</span></span>
<span></span>
<span><span class="co"># Example smoothing effectiveness analysis:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Smoothing effectiveness:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Smoothing effectiveness:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Original - Mean:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">extracted_values</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"SD:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">extracted_values</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Original - Mean: 0.119 SD: 0.202</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Smoothed coastal vegetation values:\n"</span><span class="op">)</span>  </span>
<span><span class="co">#&gt; Smoothed coastal vegetation values:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Mean:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">smoothing_results</span><span class="op">$</span><span class="va">coastal_vegetation</span><span class="op">$</span><span class="va">weighted_combined</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Mean: 0.119</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  SD:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">smoothing_results</span><span class="op">$</span><span class="va">coastal_vegetation</span><span class="op">$</span><span class="va">weighted_combined</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   SD: 0.153</span></span>
<span></span>
<span><span class="va">noise_reduction</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">extracted_values</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">-</span> </span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">smoothing_results</span><span class="op">$</span><span class="va">coastal_vegetation</span><span class="op">$</span><span class="va">weighted_combined</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> </span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">extracted_values</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Coastal vegetation noise reduction:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">noise_reduction</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Coastal vegetation noise reduction: 24.4 %</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"(Lower standard deviation = more consistent coastal vegetation patterns)\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; (Lower standard deviation = more consistent coastal vegetation patterns)</span></span>
<span></span>
<span><span class="co"># The smoothing results contain:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n=== SMOOTHING RESULTS EXPLAINED ===\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === SMOOTHING RESULTS EXPLAINED ===</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- raw: Mean of center cell + all neighbors (unweighted)\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; - raw: Mean of center cell + all neighbors (unweighted)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- neighbors_1st: Average of first-order neighbors only\n"</span><span class="op">)</span>  </span>
<span><span class="co">#&gt; - neighbors_1st: Average of first-order neighbors only</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- neighbors_2nd: Average of second-order neighbors only\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; - neighbors_2nd: Average of second-order neighbors only</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- weighted_combined: Weighted average (center + all neighbors) ★\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; - weighted_combined: Weighted average (center + all neighbors) ★</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n★ weighted_combined is typically the best result for noise reduction\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ★ weighted_combined is typically the best result for noise reduction</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="advanced-n-order-smoothing-for-enhanced-results">Advanced: N-Order Smoothing for Enhanced Results<a class="anchor" aria-label="anchor" href="#advanced-n-order-smoothing-for-enhanced-results"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Apply 3-order smoothing using the new N-order system</span></span>
<span><span class="va">smoothing_results_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smooth_variables.html">smooth_variables</a></span><span class="op">(</span></span>
<span>  variable_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>coastal_vegetation <span class="op">=</span> <span class="va">extracted_values</span><span class="op">)</span>,</span>
<span>  neighbors <span class="op">=</span> <span class="va">topology_3</span><span class="op">$</span><span class="va">neighbors</span>,</span>
<span>  weights <span class="op">=</span> <span class="va">topology_3</span><span class="op">$</span><span class="va">weights</span>,</span>
<span>  var_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"coastal_vegetation"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Using C++ implementation for N-order smoothing</span></span>
<span><span class="co">#&gt; Processing hexagon 5000 of 11223Processing hexagon 10000 of 11223</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"3-Order spatial smoothing complete\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; 3-Order spatial smoothing complete</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Results:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">smoothing_results_3</span><span class="op">$</span><span class="va">coastal_vegetation</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Results: raw, weighted_combined, neighbors_1st, neighbors_2nd, neighbors_3rd</span></span>
<span></span>
<span><span class="co"># Compare 2-order vs 3-order smoothing</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n=== COMPARING SMOOTHING APPROACHES ===\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === COMPARING SMOOTHING APPROACHES ===</span></span>
<span></span>
<span><span class="co"># 2-order results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"2-Order smoothing:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; 2-Order smoothing:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Mean:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">smoothing_results</span><span class="op">$</span><span class="va">coastal_vegetation</span><span class="op">$</span><span class="va">weighted_combined</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Mean: 0.119</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  SD:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">smoothing_results</span><span class="op">$</span><span class="va">coastal_vegetation</span><span class="op">$</span><span class="va">weighted_combined</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   SD: 0.153</span></span>
<span></span>
<span><span class="co"># 3-order results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"3-Order smoothing:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; 3-Order smoothing:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Mean:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">smoothing_results_3</span><span class="op">$</span><span class="va">coastal_vegetation</span><span class="op">$</span><span class="va">weighted_combined</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Mean: 0.12</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  SD:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">smoothing_results_3</span><span class="op">$</span><span class="va">coastal_vegetation</span><span class="op">$</span><span class="va">weighted_combined</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   SD: 0.138</span></span>
<span></span>
<span><span class="co"># Additional 3-order results available</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n3-Order specific results:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 3-Order specific results:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- neighbors_1st:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">smoothing_results_3</span><span class="op">$</span><span class="va">coastal_vegetation</span><span class="op">$</span><span class="va">neighbors_1st</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; - neighbors_1st: 0.119</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- neighbors_2nd:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">smoothing_results_3</span><span class="op">$</span><span class="va">coastal_vegetation</span><span class="op">$</span><span class="va">neighbors_2nd</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; - neighbors_2nd: 0.119</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- neighbors_3rd:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">smoothing_results_3</span><span class="op">$</span><span class="va">coastal_vegetation</span><span class="op">$</span><span class="va">neighbors_3rd</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; - neighbors_3rd: 0.12</span></span>
<span></span>
<span><span class="co"># Calculate additional noise reduction from 3-order smoothing</span></span>
<span><span class="va">noise_reduction_3</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">extracted_values</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">-</span> </span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">smoothing_results_3</span><span class="op">$</span><span class="va">coastal_vegetation</span><span class="op">$</span><span class="va">weighted_combined</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> </span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">extracted_values</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"3-Order noise reduction:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">noise_reduction_3</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; 3-Order noise reduction: 31.8 %</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Additional reduction over 2-order:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">noise_reduction_3</span> <span class="op">-</span> <span class="va">noise_reduction</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Additional reduction over 2-order: 7.3 %</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="when-to-use-higher-orders">When to Use Higher Orders<a class="anchor" aria-label="anchor" href="#when-to-use-higher-orders"></a>
</h3>
<ul>
<li>
<strong>2 orders (default)</strong>: Best for most applications,
balanced performance and smoothing</li>
<li>
<strong>3-4 orders</strong>: Use when you need more extensive
smoothing or have noisy data</li>
<li>
<strong>5+ orders</strong>: Use sparingly for very large-scale
patterns, but be aware of increased computation time</li>
<li>
<strong>Custom weights</strong>: Use when you need specific spatial
decay patterns for your analysis</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="step-6-combine-results-and-analyze">Step 6: Combine Results and Analyze<a class="anchor" aria-label="anchor" href="#step-6-combine-results-and-analyze"></a>
</h2>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Combine the hexagonal grid with smoothing results</span></span>
<span><span class="va">hex_grid_with_results</span> <span class="op">&lt;-</span> <span class="va">hex_grid</span></span>
<span><span class="va">hex_grid_with_results</span><span class="op">$</span><span class="va">coastal_vegetation_raw</span> <span class="op">&lt;-</span> <span class="va">smoothing_results</span><span class="op">$</span><span class="va">coastal_vegetation</span><span class="op">$</span><span class="va">raw</span></span>
<span><span class="va">hex_grid_with_results</span><span class="op">$</span><span class="va">coastal_vegetation_neighbors_1st</span> <span class="op">&lt;-</span> <span class="va">smoothing_results</span><span class="op">$</span><span class="va">coastal_vegetation</span><span class="op">$</span><span class="va">neighbors_1st</span></span>
<span><span class="va">hex_grid_with_results</span><span class="op">$</span><span class="va">coastal_vegetation_neighbors_2nd</span> <span class="op">&lt;-</span> <span class="va">smoothing_results</span><span class="op">$</span><span class="va">coastal_vegetation</span><span class="op">$</span><span class="va">neighbors_2nd</span></span>
<span><span class="va">hex_grid_with_results</span><span class="op">$</span><span class="va">coastal_vegetation_weighted_combined</span> <span class="op">&lt;-</span> <span class="va">smoothing_results</span><span class="op">$</span><span class="va">coastal_vegetation</span><span class="op">$</span><span class="va">weighted_combined</span></span>
<span></span>
<span><span class="co"># Transform to WGS84 for plotting</span></span>
<span><span class="va">hex_grid_with_results_wgs84</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">hex_grid_with_results</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Results combined with grid successfully\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Results combined with grid successfully</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Available columns:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">hex_grid_with_results</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Available columns: sf..st_make_grid.study_area_proj..cellsize...grid_size..square....type...., grid_id, grid_index, coastal_vegetation_raw, coastal_vegetation_neighbors_1st, coastal_vegetation_neighbors_2nd, coastal_vegetation_weighted_combined</span></span>
<span></span>
<span><span class="co"># Analyze the smoothing effect</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n=== SMOOTHING ANALYSIS ===\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === SMOOTHING ANALYSIS ===</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Understanding the smoothing results:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Understanding the smoothing results:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- raw: Mean of center cell + all neighbors (unweighted)\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; - raw: Mean of center cell + all neighbors (unweighted)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- neighbors_1st: Mean of first-order neighbors only\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; - neighbors_1st: Mean of first-order neighbors only</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- neighbors_2nd: Mean of second-order neighbors only\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; - neighbors_2nd: Mean of second-order neighbors only</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- weighted_combined: Weighted average (center + all neighbors, weights applied to each neighbor)\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; - weighted_combined: Weighted average (center + all neighbors, weights applied to each neighbor)</span></span>
<span></span>
<span><span class="co"># Example analysis output:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Original values - Count:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">extracted_values</span><span class="op">)</span>, <span class="st">"Mean:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">extracted_values</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"SD:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">extracted_values</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Original values - Count: 11223 Mean: 0.1195 SD: 0.2021</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Smoothed values - Count:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">smoothing_results</span><span class="op">$</span><span class="va">coastal_vegetation</span><span class="op">$</span><span class="va">weighted_combined</span><span class="op">)</span>, <span class="st">"Mean:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">smoothing_results</span><span class="op">$</span><span class="va">coastal_vegetation</span><span class="op">$</span><span class="va">weighted_combined</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"SD:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">smoothing_results</span><span class="op">$</span><span class="va">coastal_vegetation</span><span class="op">$</span><span class="va">weighted_combined</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Smoothed values - Count: 11223 Mean: 0.1195 SD: 0.1527</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Variance reduction:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">noise_reduction</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Variance reduction: 24.4 %</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="step-7-visualize-the-improvement">Step 7: Visualize the Improvement<a class="anchor" aria-label="anchor" href="#step-7-visualize-the-improvement"></a>
</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create spectacular before/after visualization showing the power of spatial smoothing</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"=== CREATING BEFORE/AFTER VISUALIZATION ===\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; === CREATING BEFORE/AFTER VISUALIZATION ===</span></span>
<span></span>
<span><span class="co"># Create visualization plots</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot 1: Original extracted values</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">hex_grid_wgs84</span><span class="op">)</span>, </span>
<span>     col <span class="op">=</span> <span class="va">plot_colors</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">extracted_values</span>, <span class="fl">100</span><span class="op">)</span><span class="op">]</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Original Extracted Values"</span>,</span>
<span>     border <span class="op">=</span> <span class="st">"white"</span>, lwd <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot 2: Smoothed values (1st order)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">hex_grid_wgs84</span><span class="op">)</span>, </span>
<span>     col <span class="op">=</span> <span class="va">plot_colors</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">smoothing_results</span><span class="op">$</span><span class="va">coastal_vegetation</span><span class="op">$</span><span class="va">neighbors_1st</span>, <span class="fl">100</span><span class="op">)</span><span class="op">]</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Smoothed (1st Order Neighbors)"</span>,</span>
<span>     border <span class="op">=</span> <span class="st">"white"</span>, lwd <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot 3: Smoothed values (2nd order)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">hex_grid_wgs84</span><span class="op">)</span>, </span>
<span>     col <span class="op">=</span> <span class="va">plot_colors</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">smoothing_results</span><span class="op">$</span><span class="va">coastal_vegetation</span><span class="op">$</span><span class="va">neighbors_2nd</span>, <span class="fl">100</span><span class="op">)</span><span class="op">]</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Smoothed (2nd Order Neighbors)"</span>,</span>
<span>     border <span class="op">=</span> <span class="st">"white"</span>, lwd <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot 4: Final weighted combined result</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">hex_grid_wgs84</span><span class="op">)</span>, </span>
<span>     col <span class="op">=</span> <span class="va">plot_colors</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">smoothing_results</span><span class="op">$</span><span class="va">coastal_vegetation</span><span class="op">$</span><span class="va">weighted_combined</span>, <span class="fl">100</span><span class="op">)</span><span class="op">]</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Final Weighted Combined Result"</span>,</span>
<span>     border <span class="op">=</span> <span class="st">"white"</span>, lwd <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span></code></pre></div>
<p><img src="hexsmoothR-complete-guide_files/figure-html/visualize-results-1.png" class="r-plt" alt="" width="960"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"All visualization plots created successfully!\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; All visualization plots created successfully!</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Progression shows:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Progression shows:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- Top left: Raw extracted data\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; - Top left: Raw extracted data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- Top right: 1st order neighbor smoothing\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; - Top right: 1st order neighbor smoothing</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- Bottom left: 2nd order neighbor smoothing\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; - Bottom left: 2nd order neighbor smoothing</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- Bottom right: Final weighted combined result\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; - Bottom right: Final weighted combined result</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="step-8-working-with-multiple-variables">Step 8: Working with Multiple Variables<a class="anchor" aria-label="anchor" href="#step-8-working-with-multiple-variables"></a>
</h2>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># You can work with multiple raster files and variables</span></span>
<span><span class="va">raster_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  ndvi <span class="op">=</span> <span class="st">"path/to/your/ndvi.tif"</span>,</span>
<span>  elevation <span class="op">=</span> <span class="st">"path/to/your/elevation.tif"</span>,</span>
<span>  precipitation <span class="op">=</span> <span class="st">"path/to/your/precipitation.tif"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract multiple variables</span></span>
<span><span class="va">extracted_multi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_raster_data.html">extract_raster_data</a></span><span class="op">(</span></span>
<span>  raster_files <span class="op">=</span> <span class="va">raster_files</span>,</span>
<span>  study_area <span class="op">=</span> <span class="va">study_area_utm</span>,</span>
<span>  cell_size <span class="op">=</span> <span class="va">cell_size</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Apply smoothing to all variables</span></span>
<span><span class="va">variable_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  ndvi <span class="op">=</span> <span class="va">extracted_multi</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">ndvi</span>,</span>
<span>  elevation <span class="op">=</span> <span class="va">extracted_multi</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">elevation</span>,</span>
<span>  precipitation <span class="op">=</span> <span class="va">extracted_multi</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">precipitation</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">smoothing_multi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smooth_variables.html">smooth_variables</a></span><span class="op">(</span></span>
<span>  variable_values <span class="op">=</span> <span class="va">variable_values</span>,</span>
<span>  neighbors <span class="op">=</span> <span class="va">topology</span><span class="op">$</span><span class="va">neighbors</span>,</span>
<span>  weights <span class="op">=</span> <span class="va">topology</span><span class="op">$</span><span class="va">weights</span>,</span>
<span>  var_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ndvi"</span>, <span class="st">"elevation"</span>, <span class="st">"precipitation"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Each variable gets the same smoothing treatment</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Variables processed:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">smoothing_multi</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="step-9-hexagon-measurement-utilities">Step 9: Hexagon Measurement Utilities<a class="anchor" aria-label="anchor" href="#step-9-hexagon-measurement-utilities"></a>
</h2>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The package provides helper functions for hexagon measurements</span></span>
<span><span class="co"># IMPORTANT: cell_size_flat is in METERS (UTM coordinates)</span></span>
<span><span class="va">cell_size_flat</span> <span class="op">&lt;-</span> <span class="fl">20000</span>  <span class="co"># 20km flat-to-flat distance in meters</span></span>
<span></span>
<span><span class="co"># Convert between different hexagon measurements</span></span>
<span><span class="va">edge_length</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hex_flat_to_edge.html">hex_flat_to_edge</a></span><span class="op">(</span><span class="va">cell_size_flat</span><span class="op">)</span></span>
<span><span class="va">circumradius</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hex_flat_to_edge.html">hex_flat_to_circumradius</a></span><span class="op">(</span><span class="va">cell_size_flat</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Hexagon measurements for"</span>, <span class="va">cell_size_flat</span>, <span class="st">"m flat-to-flat distance:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Hexagon measurements for 20000 m flat-to-flat distance:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"     - Edge length:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">edge_length</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"m\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;      - Edge length: 11547.01 m</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"     - Circumradius:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">circumradius</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"m\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;      - Circumradius: 11547.01 m</span></span>
<span></span>
<span><span class="co"># Convert back</span></span>
<span><span class="va">flat_distance_from_edge</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hex_flat_to_edge.html">hex_edge_to_flat</a></span><span class="op">(</span><span class="va">edge_length</span><span class="op">)</span></span>
<span><span class="va">flat_distance_from_circumradius</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hex_flat_to_edge.html">hex_circumradius_to_flat</a></span><span class="op">(</span><span class="va">circumradius</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Verification:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Verification:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Flat distance from edge:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">flat_distance_from_edge</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"m\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Flat distance from edge: 20000 m</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Flat distance from circumradius:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">flat_distance_from_circumradius</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"m\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Flat distance from circumradius: 20000 m</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>This vignette demonstrates the complete hexsmoothR workflow:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Grid Creation</strong>: Create hexagonal grids in projected
coordinates (UTM recommended)</li>
<li>
<strong>Raster Extraction</strong>: Extract values from raster files
into hexagon cells</li>
<li>
<strong>Topology Configuration</strong>: Set up spatial
relationships and smoothing weights</li>
<li>
<strong>Spatial Smoothing</strong>: Apply C++-optimized smoothing
algorithms</li>
<li>
<strong>Result Analysis</strong>: Visualize and analyze your
smoothed hexagon layers</li>
</ol>
<div class="section level3">
<h3 id="key-functions">Key Functions<a class="anchor" aria-label="anchor" href="#key-functions"></a>
</h3>
<ul>
<li>
<strong><code><a href="../reference/create_grid.html">create_grid()</a></code></strong> - Generate hexagonal
grids with optimal cell sizes</li>
<li>
<strong><code><a href="../reference/extract_raster_data.html">extract_raster_data()</a></code></strong> - Extract raster
values with automatic CRS handling</li>
<li>
<strong><code><a href="../reference/compute_topology.html">compute_topology()</a></code></strong> - Configure spatial
relationships and weights</li>
<li>
<strong><code><a href="../reference/smooth_variables.html">smooth_variables()</a></code></strong> - Apply fast
spatial smoothing</li>
</ul>
</div>
<div class="section level3">
<h3 id="helper-functions">Helper Functions<a class="anchor" aria-label="anchor" href="#helper-functions"></a>
</h3>
<ul>
<li>
<strong><code><a href="../reference/find_hex_cell_size_for_target_cells.html">find_hex_cell_size_for_target_cells()</a></code></strong>
- Optimize grid cell size</li>
<li>
<strong><code><a href="../reference/get_utm_crs.html">get_utm_crs()</a></code></strong> - Automatically
determine appropriate UTM projection</li>
<li>
<strong><code><a href="../reference/hex_flat_to_edge.html">hex_flat_to_edge()</a></code>,
<code><a href="../reference/hex_flat_to_edge.html">hex_edge_to_flat()</a></code></strong> - Convert between hexagon
measurements</li>
</ul>
</div>
<div class="section level3">
<h3 id="best-practices">Best Practices<a class="anchor" aria-label="anchor" href="#best-practices"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Always use projected CRS</strong> (UTM) for grid
creation</li>
<li>
<strong>Cell sizes are in meters</strong> when using projected
coordinates (UTM, State Plane, etc.)</li>
<li>
<strong>Cell sizes are in degrees</strong> when using geographic
coordinates (WGS84, NAD83, etc.)</li>
<li>
<strong>Let functions handle CRS transformations</strong>
automatically</li>
<li>
<strong>Use helper functions</strong> to optimize your workflow</li>
</ol>
</div>
<div class="section level3">
<h3 id="understanding-units-and-crs">Understanding Units and CRS<a class="anchor" aria-label="anchor" href="#understanding-units-and-crs"></a>
</h3>
<p><strong>Coordinate Reference Systems:</strong></p>
<ul>
<li>
<strong>UTM coordinates</strong>: Use meters for cell sizes (e.g.,
20000 for 20km hexagons)</li>
<li>
<strong>WGS84 coordinates</strong>: Use degrees for cell sizes
(e.g., 0.1 for ~11km hexagons)</li>
<li>
<strong>Functions automatically convert</strong> between CRS when
needed</li>
</ul>
<p><strong>Cell Size Units:</strong></p>
<ul>
<li>
<strong><code>cell_size</code> parameter</strong>: Always in the
units of your study area’s CRS</li>
<li>
<strong>UTM zones</strong>: cell_size in meters (recommended for
real-world analysis)</li>
<li>
<strong>Geographic coordinates</strong>: cell_size in degrees (use
with caution for large areas)</li>
</ul>
<p><strong>Smoothing Weights:</strong></p>
<ul>
<li>
<strong>Weights apply to each individual neighbor</strong>, not to
neighbor means</li>
<li>
<strong>Center weight</strong>: Influence of the cell itself</li>
<li>
<strong>First-order weight</strong>: Influence of each immediate
neighbor</li>
<li>
<strong>Second-order weight</strong>: Influence of each second-order
neighbor</li>
<li>
<strong>Total influence</strong> depends on the number of neighbors
each cell has</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Max M. Lang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
